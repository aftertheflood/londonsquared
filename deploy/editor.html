<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>London Squared</title>
	<link rel="stylesheet" type="text/css" href="css/london.css">
	<script src="//use.typekit.net/jac3auh.js"></script>
	<script>try{Typekit.load();}catch(e){}</script>
	<script type="text/javascript" src="js/paper-full.min.js"></script>
	<script type="text/javascript" src="js/RequestAnimationFrame.js"></script>
	<script type="text/javascript" src="js/Tween.js"></script>
	<script type="text/javascript" src="js/window-size.js"></script>
	<script type="text/javascript" src="js/londonsquared.js"></script>
	<script type="text/javascript">
		
		window.onload = function() {
			/*
			var map = new LondonSquaredMap( { canvas: "londonsquared_canvas", 
											 dataURL: "data/londonsquared.json",
											 colour: "#fa402a",
											 tileAnimateTime: 200,
											 delayBetweenTiles: 200 } )
			*/
		}
		function processForm(form){
			var boroughs = ["Enf","Hrw","Hgy","Wth",
						"Hdn","Elg","Brt","Cmd","Isl","Hck","Rdb","Hvg",
						"Hns","Hms","Kns","Wst","Cty","Tow","Nwm","Bar",
						"Rch","Wns","Lam","Swr","Lsh","Grn","Bxl",
						"Kng","Mrt","Crd"]
			
			var str = "";
			
			var max = 0
			var min = 9007199254740991
			var ret = []
			for( var b=0; b < boroughs.length; b++ ){
				//console.log( "boroughs> " + b + ": " + boroughs[b] + " " + form[b].value ) 
				var borough = boroughs[b]
				var val = parseInt( form[b].value )
				if (isNaN(val)) val = 0 // or should it be ignored if it's empty? Does every borough *have* to have data?
				
				max = Math.max( val, max )
				min = Math.min( val, min )
				
				var ob = {   key: borough,
							data: {raw: val, norm: 1}
						}
				ret.push( ob )
				//str += borough+': <input type="text" name="'+borough+'" value="" /><br /> \n'
				//console.log( str )
			}
			var diff = max - min
			// deal with diff being 0
			if (diff == 0){
				console.log("processing form - error with values: ",min, max, diff )
				diff = 1
			}
			console.log( min, max, diff )
			for( var i=0; i< ret.length; i++){
				var ob = ret[i]
				ob.data.norm = ( ob.data.raw - min ) / diff
				//console.log( ob.key, ob.data.norm, ob.data.raw )
			}
			//console.log( ret )
			var json = JSON.stringify( {data: ret} )
			
			// create a new canvas element (should override the previous one, if one exists).
			var div = document.getElementById('exportedcode')
			div.innerHTML = "<canvas id='londonsquared_canvas' width='600' height='600'></canvas><br /><a href='javascript:window.londonSquaredMap.exportMapAsPNG();'  onClick='window.londonSquaredMap.exportMapAsPNG();'>Save Canvas</a>"
			window.londonSquaredMap = new LondonSquaredMap( {
				canvas: 'londonsquared_canvas',
				data: json
			} )
			
		}
		
	</script>

</head>
<body>

	<section id="the-form">
		<form name="input_values" action="">
			Enfield: <input type="text" name="Enf" value="" /><br />
			Harrow: <input type="text" name="Hrw" value="" /><br />
			Haringay: <input type="text" name="Hgy" value="" /><br />
			wth: <input type="text" name="Wth" value="" /><br /> 
			hdn: <input type="text" name="Hdn" value="" /><br /> 
			elg: <input type="text" name="Elg" value="" /><br /> 
			brt: <input type="text" name="Brt" value="" /><br /> 
			Camden: <input type="text" name="Cmd" value="" /><br /> 
			Islington: <input type="text" name="Isl" value="" /><br /> 
			Hackney: <input type="text" name="Hck" value="" /><br /> 
			rdb: <input type="text" name="Rdb" value="" /><br /> 
			hvg: <input type="text" name="Hvg" value="" /><br /> 
			Hounslow: <input type="text" name="Hns" value="" /><br /> 
			Hammersmith & Fulham: <input type="text" name="Hms" value="" /><br /> 
			Kensington: <input type="text" name="Kns" value="" /><br /> 
			Westminster: <input type="text" name="Wst" value="" /><br /> 
			City: <input type="text" name="Cty" value="" /><br /> 
			Tower Hamlets: <input type="text" name="Tow" value="" /><br /> 
			nwm: <input type="text" name="Nwm" value="" /><br /> 
			bar: <input type="text" name="Bar" value="" /><br /> 
			rch: <input type="text" name="Rch" value="" /><br /> 
			wns: <input type="text" name="Wns" value="" /><br /> 
			lam: <input type="text" name="Lam" value="" /><br /> 
			swr: <input type="text" name="Swr" value="" /><br /> 
			lsh: <input type="text" name="Lsh" value="" /><br /> 
			grn: <input type="text" name="Grn" value="" /><br /> 
			bxl: <input type="text" name="Bxl" value="" /><br /> 
			kng: <input type="text" name="Kng" value="" /><br /> 
			mrt: <input type="text" name="Mrt" value="" /><br /> 
			crd: <input type="text" name="Crd" value="" /><br /> 

			
			
			<input type="button" name="button" onClick="processForm(this.form)" value="GO!" />
		</form>
	
	</section>
	
	<section id="the-export">
		<div id="exportedcode">
			
		</div>
		
	
	</section>


</body>
</html>
